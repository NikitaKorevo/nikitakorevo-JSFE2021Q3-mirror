/* eslint-disable object-curly-newline */
import React, { useEffect, useRef, useState } from 'react';
import './Car.scss';

function Car(props: any): JSX.Element {
  const {
    carWidth,
    carHeight,
    carColor = '#000000',
    travelTime,
    carEngineStatus,
    carLaneEl
  } = props;

  const svgEl = useRef(null);
  const [carMargin, setCarMargin] = useState('');
  const [carTransition, setCarTransition] = useState('');

  useEffect(() => {
    if (carEngineStatus === 'started') {
      setCarMargin(`calc(100% - ${carWidth}px`);
      setCarTransition(`margin-left ${travelTime}s ease-in-out`);
    }

    if (carEngineStatus === 'stopped') {
      const leftMarginCarLaneEl = carLaneEl.current.getBoundingClientRect().left;
      const widthCarLaneEl = carLaneEl.current.getBoundingClientRect().width;
      const leftMarginSvgEl = (svgEl.current as unknown as HTMLElement).getBoundingClientRect()
        .left;
      const leftMarginAfterStopped = `${
        ((leftMarginSvgEl - leftMarginCarLaneEl) / widthCarLaneEl) * 100
      }%`;
      setCarTransition('none');
      setCarMargin(leftMarginAfterStopped);
    }

    if (carEngineStatus === 'reverse') {
      setCarMargin('0');
      setCarTransition('none');
    }
  }, [carWidth, travelTime, carEngineStatus, carLaneEl]);

  return (
    <svg
      ref={svgEl}
      style={{ marginLeft: carMargin, transition: carTransition }}
      className="Car"
      width={carWidth}
      height={carHeight}
      viewBox="0 0 112 47"
      fill={carColor}
      xmlns="http://www.w3.org/2000/svg"
    >
      <path
        d="M109.504 38.0703H101.562C100.724 43.1379 96.3229 47 91.018 47C85.7132 47 81.3125 43.1379 80.4739 38.0703H32.0683C31.2297 43.1379 26.829 47 21.5242 47C16.2193 47 11.8186 43.1379 10.9802 38.0703H4.05936C2.35841 38.0703 0.859459 36.8535 0.375145 35.0787L0.158713 34.2868C0.0513016 33.8956 2.11569e-06 33.4948 2.11569e-06 33.0972C2.11569e-06 32.1289 0.307808 31.1782 0.891358 30.4167C1.46529 29.6648 1.78127 28.7173 1.78127 27.7378V23.9623L2.13717 21.9711C2.57804 19.499 3.63772 17.2081 5.2008 15.35L13.1218 5.93129C13.5323 5.44392 13.7521 4.81227 13.7521 4.16619C13.7521 3.94655 13.7264 3.72691 13.6749 3.51048C13.2597 1.75821 14.5647 0.0876927 16.2192 0.251217L22.5404 0.876457L42.6713 0.0540241C44.9542 -0.0389605 47.2387 -0.0117064 49.52 0.134183L63.8972 1.05922C65.3657 1.1506 66.8038 1.54819 68.1328 2.23275L83.7107 10.2551C84.6421 10.7344 85.6264 11.0743 86.6412 11.2651L101.451 14.0706C103.909 14.5356 105.942 16.4113 106.769 18.9748L107.819 22.2372C108.184 23.3707 108.794 24.3919 109.597 25.2144L110.349 25.9839C110.695 26.3398 110.94 26.7935 111.057 27.2953L112 31.3369V35.3513C112 36.8536 110.883 38.0703 109.504 38.0703ZM11.3055 17.9451L6.63242 18.9272C6.31067 18.9948 6.04279 19.2161 5.91566 19.5192L4.58631 22.6893C4.44395 23.0289 4.49975 23.4193 4.73125 23.7054L5.19199 24.2746C5.49627 24.6505 6.02628 24.7549 6.45047 24.5223L10.4534 22.3272C10.6068 22.243 10.7357 22.1201 10.8266 21.9705L12.3655 19.444C12.8211 18.696 12.1628 17.7649 11.3055 17.9451ZM43.0451 22.9738H46.5187C47.2712 22.9738 47.8814 22.3637 47.8814 21.6111C47.8814 20.8585 47.2712 20.2483 46.5187 20.2483H43.0451C42.2926 20.2483 41.6824 20.8585 41.6824 21.6111C41.6824 22.3636 42.2926 22.9738 43.0451 22.9738ZM27.2298 40.6003C27.7909 39.8548 28.2079 38.9987 28.4418 38.0704C28.5059 37.8235 28.5556 37.5718 28.5925 37.3153C28.2959 37.3827 27.9658 37.4211 27.6162 37.4211C27.1064 37.4211 26.6368 37.341 26.2551 37.2047C26.199 37.5045 26.1158 37.7947 26.0066 38.0704C25.8753 38.4103 25.7052 38.7309 25.5018 39.0275C25.8671 39.2023 26.2551 39.4764 26.6158 39.8371C26.8628 40.0824 27.068 40.3436 27.2298 40.6003ZM22.4173 31.5808C23.0826 31.7058 23.6998 31.9671 24.2401 32.3359C24.4132 31.9703 24.6874 31.5808 25.0481 31.2216C25.295 30.9748 25.5547 30.7695 25.8112 30.6076C24.8701 29.8974 23.7479 29.4165 22.5279 29.2449C22.5954 29.5415 22.6337 29.8718 22.6337 30.2213C22.6337 30.7311 22.552 31.2006 22.4173 31.5808ZM25.5018 33.5974C25.8705 34.1361 26.1318 34.7549 26.2551 35.4202C26.6368 35.2856 27.1065 35.2038 27.6162 35.2038C27.9658 35.2038 28.2959 35.2423 28.5925 35.3096C28.4193 34.0896 27.9402 32.9673 27.2298 32.0263C27.0679 32.2828 26.8627 32.5425 26.6158 32.7894C26.2551 33.1503 25.8671 33.4244 25.5018 33.5974ZM22.5277 43.3816C23.7477 43.2085 24.87 42.7275 25.811 42.0189C25.5545 41.857 25.2948 41.6518 25.0479 41.4049C24.6872 41.0442 24.4131 40.6546 24.2399 40.2891C23.6996 40.6578 23.0824 40.9191 22.4171 41.0442C22.5518 41.4257 22.6336 41.8955 22.6336 42.4053C22.6337 42.7549 22.5952 43.0852 22.5277 43.3816ZM21.5243 38.242C21.8065 38.242 22.0758 38.1811 22.3179 38.0704C22.988 37.7674 23.4545 37.0941 23.4545 36.3133C23.4545 35.2488 22.589 34.3831 21.5243 34.3831C20.4598 34.3831 19.5941 35.2488 19.5941 36.3133C19.5941 37.0941 20.0606 37.7674 20.7308 38.0704C20.9728 38.1809 21.2422 38.242 21.5243 38.242ZM20.5224 43.3816C20.455 43.085 20.4149 42.7548 20.4149 42.4053C20.4149 41.8955 20.4967 41.4257 20.633 41.0442C19.9661 40.9191 19.3488 40.6578 18.8086 40.2891C18.6354 40.6546 18.3613 41.0442 18.0006 41.4049C17.7537 41.6518 17.494 41.857 17.2373 42.0189C18.1784 42.7277 19.3006 43.2086 20.5224 43.3816ZM14.6067 38.0703C14.8408 38.9985 15.259 39.8546 15.8187 40.6001C15.9806 40.3436 16.1858 40.0823 16.4327 39.837C16.7934 39.4763 17.183 39.2021 17.5469 39.0274C17.3431 38.7308 17.1734 38.4101 17.0419 38.0703C16.9329 37.7945 16.8495 37.5043 16.7934 37.2046C16.4119 37.3408 15.9421 37.421 15.4323 37.421C15.0828 37.421 14.7526 37.3825 14.456 37.3152C14.4929 37.5717 14.5426 37.8235 14.6067 38.0703ZM15.8187 32.0264C15.1101 32.9675 14.6291 34.0897 14.456 35.3098C14.7526 35.2424 15.0828 35.204 15.4323 35.204C15.9423 35.204 16.4119 35.2857 16.7934 35.4204C16.9168 34.7551 17.1782 34.1362 17.5469 33.5976C17.1828 33.4244 16.7934 33.1503 16.4327 32.7895C16.1858 32.5427 15.9806 32.2828 15.8187 32.0264ZM18.0006 31.2216C18.3613 31.5808 18.6354 31.9703 18.8086 32.3359C19.3488 31.9671 19.9661 31.7058 20.633 31.5808C20.4965 31.2008 20.4149 30.7311 20.4149 30.2213C20.4149 29.8718 20.455 29.5415 20.5224 29.2449C19.3025 29.4165 18.1785 29.8974 17.2375 30.6076C17.494 30.7695 17.7537 30.9746 18.0006 31.2216ZM35.0035 4.37861L22.7042 4.88105C22.6497 4.88329 22.5951 4.88441 22.5406 4.88441C22.4089 4.88441 22.2772 4.87784 22.146 4.86485L20.2101 4.67327C19.9173 4.64426 19.6828 4.91199 19.7503 5.19848L20.4813 8.30609C21.1115 10.9848 23.3066 13.0119 26.027 13.427L31.8647 14.0722C32.1546 14.1043 32.3869 13.8451 32.3319 13.5589C32.3315 13.557 32.3311 13.5549 32.3307 13.553C31.9295 11.4525 32.3832 9.33052 33.6083 7.5776L35.3727 5.05307C35.576 4.76225 35.3583 4.36418 35.0035 4.37861ZM81.9538 13.8582C81.9281 13.8451 81.9023 13.8319 81.8767 13.8188L66.2981 5.79614C65.4603 5.36457 64.5691 5.11688 63.6488 5.05964L49.263 4.13412C47.9572 4.0506 46.6327 4.00827 45.3274 4.00827C44.4997 4.00827 43.6611 4.02543 42.8348 4.05894C41.617 4.10863 40.4926 4.72426 39.7944 5.72304L36.8933 9.87384C35.6525 11.6494 36.1203 14.0987 37.9282 15.2921L39.0257 16.0164C39.6437 16.4243 40.3662 16.6454 41.1067 16.6529L81.2154 17.0622C81.8153 17.0683 82.3877 16.7537 82.6997 16.2058C83.177 15.3671 82.8142 14.2946 81.9538 13.8582ZM96.7237 40.6003C97.2832 39.8548 97.7016 38.9987 97.9355 38.0704C97.9996 37.8235 98.0493 37.5718 98.0864 37.3153C97.7898 37.3827 97.4595 37.4211 97.11 37.4211C96.6001 37.4211 96.1305 37.341 95.7489 37.2047C95.6928 37.5045 95.6095 37.7947 95.5005 38.0704C95.369 38.4103 95.1991 38.7309 94.9955 39.0275C95.3595 39.2023 95.7489 39.4764 96.1097 39.8371C96.3565 40.0824 96.5617 40.3436 96.7237 40.6003ZM92.02 43.3816C93.2398 43.2085 94.3638 42.7275 95.3049 42.0189C95.0482 41.857 94.7885 41.6518 94.5416 41.4049C94.1809 41.0442 93.9068 40.6546 93.7336 40.2891C93.1934 40.6578 92.5761 40.9191 91.9092 41.0442C92.0457 41.4257 92.1273 41.8955 92.1273 42.4053C92.1274 42.7549 92.0873 43.0852 92.02 43.3816ZM90.0144 43.3816C89.947 43.085 89.9086 42.7548 89.9086 42.4053C89.9086 41.8955 89.9904 41.4257 90.1251 41.0442C89.4598 40.9191 88.8425 40.6578 88.3023 40.2891C88.1291 40.6546 87.855 41.0442 87.4943 41.4049C87.2474 41.6518 86.9877 41.857 86.7312 42.0189C87.6722 42.7277 88.7944 43.2086 90.0144 43.3816ZM84.1004 38.0703C84.3345 38.9985 84.7514 39.8546 85.3125 40.6001C85.4745 40.3436 85.6797 40.0823 85.9266 39.837C86.2873 39.4763 86.6752 39.2021 87.0406 39.0274C86.837 38.7308 86.6671 38.4101 86.5358 38.0703C86.4266 37.7945 86.3434 37.5043 86.2873 37.2046C85.9056 37.3408 85.4358 37.421 84.9262 37.421C84.5765 37.421 84.2464 37.3825 83.9499 37.3152C83.9866 37.5717 84.0363 37.8235 84.1004 38.0703ZM85.9264 32.7895C85.6795 32.5427 85.4743 32.283 85.3124 32.0264C84.602 32.9675 84.1228 34.0897 83.9497 35.3098C84.2463 35.2424 84.5764 35.204 84.926 35.204C85.4358 35.204 85.9054 35.2857 86.2871 35.4204C86.4105 34.7551 86.6717 34.1362 87.0404 33.5976C86.6751 33.4244 86.2871 33.1503 85.9264 32.7895ZM90.0144 29.2448C88.7944 29.4163 87.6722 29.8973 86.7312 30.6075C86.9877 30.7694 87.2474 30.9746 87.4943 31.2215C87.855 31.5806 88.1291 31.9702 88.3023 32.3357C88.8425 31.967 89.4598 31.7056 90.1251 31.5806C89.9904 31.2006 89.9086 30.7309 89.9086 30.2211C89.9086 29.8716 89.947 29.5415 90.0144 29.2448ZM89.0878 36.3133C89.0878 37.0941 89.5543 37.7674 90.2245 38.0704C90.4665 38.1811 90.7359 38.242 91.018 38.242C91.3002 38.242 91.5695 38.1811 91.8116 38.0704C92.4817 37.7674 92.9482 37.0941 92.9482 36.3133C92.9482 35.2488 92.0825 34.3831 91.018 34.3831C89.9534 34.383 89.0878 35.2487 89.0878 36.3133ZM92.02 29.2448C92.0873 29.5413 92.1274 29.8716 92.1274 30.2211C92.1274 30.7309 92.0457 31.2006 91.9094 31.5806C92.5763 31.7056 93.1935 31.967 93.7338 32.3357C93.9069 31.9702 94.1811 31.5806 94.5418 31.2215C94.7887 30.9746 95.0484 30.7694 95.305 30.6075C94.3638 29.8974 93.2398 29.4165 92.02 29.2448ZM96.1097 32.7895C95.7489 33.1503 95.3594 33.4244 94.9955 33.5976C95.3642 34.1362 95.6257 34.7551 95.7489 35.4204C96.1305 35.2857 96.6002 35.204 97.11 35.204C97.4595 35.204 97.7898 35.2424 98.0864 35.3098C97.9132 34.0897 97.4323 32.9675 96.7237 32.0264C96.5617 32.2828 96.3565 32.5427 96.1097 32.7895ZM105.497 22.6895L104.168 19.5194C104.041 19.2162 103.773 18.9948 103.451 18.9273L98.7783 17.9452C97.9207 17.765 97.2625 18.6961 97.7183 19.4443L99.2571 21.9708C99.3482 22.1204 99.4769 22.2433 99.6305 22.3275L103.633 24.5226C104.057 24.7552 104.587 24.6508 104.892 24.2749L105.353 23.7058C105.584 23.4194 105.64 23.0291 105.497 22.6895Z"
        fill=""
      />
    </svg>
  );
}

export default Car;
